## Copying STM function for speed
import numpy as np
def Afn(x,y,z,xdot,ydot,zdot,rho):
	A = np.zeros((6,6))
	A[0, 3] = 1
	A[1, 4] = 1
	A[2, 5] = 1

	A[3,0] = 5.31749536471273e-9*rho*x*xdot*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5) + 3.87757922595094e-13*rho*x*y*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5) - 7.29211585530066e-5*rho*xdot*ydot*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5) - 5.31749536471273e-9*rho*y*ydot*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5) + 41255653550549.8*x**2*z**3*(x**2 + y**2 + z**2)**(-5.5) - 921644432691.79*x**2*z**2*(x**2 + y**2 + z**2)**(-4.5) - 13751884516849.9*x**2*z*(x**2 + y**2 + z**2)**(-4.5) + 131663490384.541*x**2*(x**2 + y**2 + z**2)**(-3.5) + 1195801.3245*x**2*(x**2 + y**2 + z**2)**(-2.5) - 4583961505616.64*z**3*(x**2 + y**2 + z**2)**(-4.5) + 131663490384.541*z**2*(x**2 + y**2 + z**2)**(-3.5) + 1964554930978.56*z*(x**2 + y**2 + z**2)**(-3.5) - 26332698076.9083*(x**2 + y**2 + z**2)**(-2.5) - 398600.4415*(x**2 + y**2 + z**2)**(-1.5)
	A[3,1] = 7.29211585530066e-5*rho*xdot**2*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5) + 1.06349907294255e-8*rho*xdot*y*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5) + 3.87757922595094e-13*rho*y**2*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5) + 7.29211585530066e-5*rho*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**0.5 + 41255653550549.8*x*y*z**3*(x**2 + y**2 + z**2)**(-5.5) - 921644432691.79*x*y*z**2*(x**2 + y**2 + z**2)**(-4.5) - 13751884516849.9*x*y*z*(x**2 + y**2 + z**2)**(-4.5) + 131663490384.541*x*y*(x**2 + y**2 + z**2)**(-3.5) + 1195801.3245*x*y*(x**2 + y**2 + z**2)**(-2.5)
	A[3,2] = 41255653550549.8*x*z**4*(x**2 + y**2 + z**2)**(-5.5) - 921644432691.79*x*z**3*(x**2 + y**2 + z**2)**(-4.5) - 27503769033699.9*x*z**2*(x**2 + y**2 + z**2)**(-4.5) + 394990471153.624*x*z*(x**2 + y**2 + z**2)**(-3.5) + 1195801.3245*x*z*(x**2 + y**2 + z**2)**(-2.5) + 1964554930978.56*x*(x**2 + y**2 + z**2)**(-3.5)
	A[3,3] = rho*((xdot + 7.29211585530066e-5*y)*(1.0*xdot + 7.29211585530066e-5*y) + (zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**1.0)*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5)
	A[3,4] = -rho*(7.29211585530066e-5*x - 1.0*ydot)*(xdot + 7.29211585530066e-5*y)*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5)
	A[3,5] = 1.0*rho*zdot*(xdot + 7.29211585530066e-5*y)*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5)
	A[4,0] = -3.87757922595094e-13*rho*x**2*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5) + 1.06349907294255e-8*rho*x*ydot*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5) - 7.29211585530066e-5*rho*ydot**2*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5) - 7.29211585530066e-5*rho*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**0.5 + 41255653550549.8*x*y*z**3*(x**2 + y**2 + z**2)**(-5.5) - 921644432691.79*x*y*z**2*(x**2 + y**2 + z**2)**(-4.5) - 13751884516849.9*x*y*z*(x**2 + y**2 + z**2)**(-4.5) + 131663490384.541*x*y*(x**2 + y**2 + z**2)**(-3.5) + 1195801.3245*x*y*(x**2 + y**2 + z**2)**(-2.5)
	A[4,1] = -5.31749536471273e-9*rho*x*xdot*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5) - 3.87757922595094e-13*rho*x*y*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5) + 7.29211585530066e-5*rho*xdot*ydot*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5) + 5.31749536471273e-9*rho*y*ydot*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5) + 41255653550549.8*y**2*z**3*(x**2 + y**2 + z**2)**(-5.5) - 921644432691.79*y**2*z**2*(x**2 + y**2 + z**2)**(-4.5) - 13751884516849.9*y**2*z*(x**2 + y**2 + z**2)**(-4.5) + 131663490384.541*y**2*(x**2 + y**2 + z**2)**(-3.5) + 1195801.3245*y**2*(x**2 + y**2 + z**2)**(-2.5) - 4583961505616.64*z**3*(x**2 + y**2 + z**2)**(-4.5) + 131663490384.541*z**2*(x**2 + y**2 + z**2)**(-3.5) + 1964554930978.56*z*(x**2 + y**2 + z**2)**(-3.5) - 26332698076.9083*(x**2 + y**2 + z**2)**(-2.5) - 398600.4415*(x**2 + y**2 + z**2)**(-1.5)
	A[4,2] = 41255653550549.8*y*z**4*(x**2 + y**2 + z**2)**(-5.5) - 921644432691.79*y*z**3*(x**2 + y**2 + z**2)**(-4.5) - 27503769033699.9*y*z**2*(x**2 + y**2 + z**2)**(-4.5) + 394990471153.624*y*z*(x**2 + y**2 + z**2)**(-3.5) + 1195801.3245*y*z*(x**2 + y**2 + z**2)**(-2.5) + 1964554930978.56*y*(x**2 + y**2 + z**2)**(-3.5)
	A[4,3] = -rho*(7.29211585530066e-5*x - ydot)*(1.0*xdot + 7.29211585530066e-5*y)*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5)
	A[4,4] = rho*((7.29211585530066e-5*x - ydot)*(7.29211585530066e-5*x - 1.0*ydot) + (zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**1.0)*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5)
	A[4,5] = -1.0*rho*zdot*(7.29211585530066e-5*x - ydot)*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5)
	A[5,0] = 5.31749536471273e-9*rho*x*zdot*(5.31749536471273e-9*x**2 - 0.000145842317106013*x*ydot + xdot**2 + 0.000145842317106013*xdot*y + 5.31749536471273e-9*y**2 + ydot**2 + zdot**2)**(-0.5) - 7.29211585530066e-5*rho*ydot*zdot*(5.31749536471273e-9*x**2 - 0.000145842317106013*x*ydot + xdot**2 + 0.000145842317106013*xdot*y + 5.31749536471273e-9*y**2 + ydot**2 + zdot**2)**(-0.5) + 41255653550549.8*x*z**4*(x**2 + y**2 + z**2)**(-5.5) - 921644432691.79*x*z**3*(x**2 + y**2 + z**2)**(-4.5) - 27503769033699.9*x*z**2*(x**2 + y**2 + z**2)**(-4.5) + 394990471153.624*x*z*(x**2 + y**2 + z**2)**(-3.5) + 1195801.3245*x*z*(x**2 + y**2 + z**2)**(-2.5) + 1964554930978.56*x*(x**2 + y**2 + z**2)**(-3.5)
	A[5,1] = 7.29211585530066e-5*rho*xdot*zdot*(5.31749536471273e-9*x**2 - 0.000145842317106013*x*ydot + xdot**2 + 0.000145842317106013*xdot*y + 5.31749536471273e-9*y**2 + ydot**2 + zdot**2)**(-0.5) + 5.31749536471273e-9*rho*y*zdot*(5.31749536471273e-9*x**2 - 0.000145842317106013*x*ydot + xdot**2 + 0.000145842317106013*xdot*y + 5.31749536471273e-9*y**2 + ydot**2 + zdot**2)**(-0.5) + 41255653550549.8*y*z**4*(x**2 + y**2 + z**2)**(-5.5) - 921644432691.79*y*z**3*(x**2 + y**2 + z**2)**(-4.5) - 27503769033699.9*y*z**2*(x**2 + y**2 + z**2)**(-4.5) + 394990471153.624*y*z*(x**2 + y**2 + z**2)**(-3.5) + 1195801.3245*y*z*(x**2 + y**2 + z**2)**(-2.5) + 1964554930978.56*y*(x**2 + y**2 + z**2)**(-3.5)
	A[5,2] = 41255653550549.8*z**5*(x**2 + y**2 + z**2)**(-5.5) - 921644432691.79*z**4*(x**2 + y**2 + z**2)**(-4.5) - 45839615056166.5*z**3*(x**2 + y**2 + z**2)**(-4.5) + 789980942307.248*z**2*(x**2 + y**2 + z**2)**(-3.5) + 1195801.3245*z**2*(x**2 + y**2 + z**2)**(-2.5) + 9822774654892.81*z*(x**2 + y**2 + z**2)**(-3.5) - 78998094230.7248*(x**2 + y**2 + z**2)**(-2.5) - 398600.4415*(x**2 + y**2 + z**2)**(-1.5)
	A[5,3] = rho*zdot*(1.0*xdot + 7.29211585530066e-5*y)*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5)
	A[5,4] = -rho*zdot*(7.29211585530066e-5*x - 1.0*ydot)*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5)
	A[5,5] = rho*(1.0*zdot**2 + (zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**1.0)*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**(-0.5)
	rddot = []
	rddot.append(rho*xdot*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**0.5 + 7.29211585530066e-5*rho*y*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**0.5 - 4583961505616.64*x*z**3*(x**2 + y**2 + z**2)**(-4.5) + 131663490384.541*x*z**2*(x**2 + y**2 + z**2)**(-3.5) + 1964554930978.56*x*z*(x**2 + y**2 + z**2)**(-3.5) - 26332698076.9083*x*(x**2 + y**2 + z**2)**(-2.5) - 398600.4415*x*(x**2 + y**2 + z**2)**(-1.5))
	rddot.append(-7.29211585530066e-5*rho*x*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**0.5 + rho*ydot*(zdot**2 + (7.29211585530066e-5*x - ydot)**2 + (xdot + 7.29211585530066e-5*y)**2)**0.5 - 4583961505616.64*y*z**3*(x**2 + y**2 + z**2)**(-4.5) + 131663490384.541*y*z**2*(x**2 + y**2 + z**2)**(-3.5) + 1964554930978.56*y*z*(x**2 + y**2 + z**2)**(-3.5) - 26332698076.9083*y*(x**2 + y**2 + z**2)**(-2.5) - 398600.4415*y*(x**2 + y**2 + z**2)**(-1.5))
	rddot.append(1.0*rho*zdot*(5.31749536471273e-9*x**2 - 0.000145842317106013*x*ydot + xdot**2 + 0.000145842317106013*xdot*y + 5.31749536471273e-9*y**2 + ydot**2 + zdot**2)**0.5 - 4583961505616.64*z**4*(x**2 + y**2 + z**2)**(-4.5) + 131663490384.541*z**3*(x**2 + y**2 + z**2)**(-3.5) + 3929109861957.12*z**2*(x**2 + y**2 + z**2)**(-3.5) - 78998094230.7248*z*(x**2 + y**2 + z**2)**(-2.5) - 398600.4415*z*(x**2 + y**2 + z**2)**(-1.5) - 392910986195.712*(x**2 + y**2 + z**2)**(-2.5))
	return rddot,A